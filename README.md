# ETF Monitor + –ë–∞–ª–∞–Ω—Å–∏—Ä–æ–≤—â–∏–∫ –ø–æ—Ä—Ç—Ñ–µ–ª—è –¢–∏–Ω—å–∫–æ—Ñ—Ñ

–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ ETF —Ñ–æ–Ω–¥–æ–≤ –¢-–ö–∞–ø–∏—Ç–∞–ª —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–≥–æ Tinkoff Invest API –∏ **–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤—â–∏–∫ –ø–æ—Ä—Ç—Ñ–µ–ª—è** –Ω–∞ –æ—Å–Ω–æ–≤–µ market cap —Ñ–æ–Ω–¥–æ–≤.

## üöÄ –ù–æ–≤–∏–Ω–∫–∞: –ë–æ—Ç-–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤—â–∏–∫ –ø–æ—Ä—Ç—Ñ–µ–ª—è

**–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤—â–∏–∫**, –∫–æ—Ç–æ—Ä—ã–π —Ä–µ–∞–ª–∏–∑—É–µ—Ç —Å—Ç—Ä–∞—Ç–µ–≥–∏—é:
> "–£–º–µ–Ω—å—à–∞–µ—Ç—Å—è –¥–æ–ª—è –Ω–∞ —Ä—ã–Ω–∫–µ —ç—Ç–æ–≥–æ —Ñ–æ–Ω–¥–∞ - –ø–æ—Ä–∞ –µ–≥–æ –ø—Ä–æ–¥–∞–≤–∞—Ç—å, —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è - –ø–æ—Ä–∞ –ø–æ–∫—É–ø–∞—Ç—å"

### ‚ú® –ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤—â–∏–∫–∞:
- üéØ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ä–∞—Å—á–µ—Ç –ø—Ä–æ–ø–æ—Ä—Ü–∏–π** –Ω–∞ –æ—Å–Ω–æ–≤–µ market cap —Ñ–æ–Ω–¥–æ–≤ –¢–∏–Ω—å–∫–æ—Ñ—Ñ
- ‚è∞ **–£–º–Ω–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ —Ç–æ—Ä–≥–æ–≤–ª–∏** —á–µ—Ä–µ–∑ –∞–Ω–∞–ª–∏–∑ –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏
- üõ°Ô∏è **–ë–µ–∑–æ–ø–∞—Å–Ω—ã–π —Ä–µ–∂–∏–º DRY_RUN** –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
- üìä **–†–µ–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞ —Ä–∞–∑ –≤ —Å—É—Ç–∫–∏** –≤ –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è
- üí∞ **–î–∏–≤–µ—Ä—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –ø–æ –≤—Å–µ–º —Ñ–æ–Ω–¥–∞–º** –¢–∏–Ω—å–∫–æ—Ñ—Ñ –±–µ–∑ –∫–æ–º–∏—Å—Å–∏–π

## –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ —Å–∏—Å—Ç–µ–º—ã

- üìä **–°–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö ETF** —á–µ—Ä–µ–∑ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π Tinkoff Invest API
- üë• **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏–Ω–≤–µ—Å—Ç–æ—Ä–æ–≤** —á–µ—Ä–µ–∑ —Å–∫—Ä–µ–π–ø–∏–Ω–≥ —Å–∞–π—Ç–∞ T-Capital
- ü§ñ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞ –ø–æ—Ä—Ç—Ñ–µ–ª—è** –ø–æ market cap
- üóÑÔ∏è **–ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ** –¥–∞–Ω–Ω—ã—Ö –≤ PostgreSQL
- ‚è∞ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ** –ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é
- üìà **–ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞** –ø–æ —Å–æ–±—Ä–∞–Ω–Ω—ã–º –¥–∞–Ω–Ω—ã–º

## –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫

- **Node.js** - –æ—Å–Ω–æ–≤–Ω–∞—è –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞
- **Tinkoff Invest API** - –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–µ API –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö ETF
- **Puppeteer** - –≤–µ–±-—Å–∫—Ä–µ–π–ø–∏–Ω–≥ –¥–ª—è –¥–∞–Ω–Ω—ã—Ö –æ–± –∏–Ω–≤–µ—Å—Ç–æ—Ä–∞—Ö
- **PostgreSQL** - –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö
- **node-cron** - –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –∑–∞–¥–∞—á

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

### 1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è

```bash
git clone <repository-url>
cd etf-monitor
```

### 2. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
npm install
```

### 3. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è

–°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Ñ–∞–π–ª `.env.example` –≤ `.env` –∏ –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:

```bash
cp .env.example .env
```

–û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ `.env`:

```env
# Tinkoff Invest API Token (–ø–æ–ª—É—á–∏—Ç—å –Ω–∞ https://www.tbank.ru/invest/settings/)
TINKOFF_TOKEN=your_production_readonly_token

# PostgreSQL Database Connection
DATABASE_URL=postgres://user:password@localhost:5432/etf_monitor

# –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
ETF_FETCH_INTERVAL=5
INVESTORS_FETCH_INTERVAL=30
PUPPETEER_HEADLESS=true
PUPPETEER_TIMEOUT=30000
LOG_LEVEL=info
```

### 4. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

–°–æ–∑–¥–∞–π—Ç–µ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö PostgreSQL –∏ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫—É —Å—Ö–µ–º—ã:

```bash
# –°–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü
npm run setup-db
```

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –ó–∞–ø—É—Å–∫ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞

```bash
# –ó–∞–ø—É—Å–∫ —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–æ–º
npm start

# –ó–∞–ø—É—Å–∫ –≤ —Ä–µ–∂–∏–º–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ —Å –∞–≤—Ç–æ–ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–æ–π
npm run dev
```

### –†—É—á–Ω–æ–π –∑–∞–ø—É—Å–∫ —Å–∫—Ä–∏–ø—Ç–æ–≤

```bash
# –°–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö ETF —á–µ—Ä–µ–∑ API
npm run fetch-etfs

# –°–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö –æ–± –∏–Ω–≤–µ—Å—Ç–æ—Ä–∞—Ö
npm run fetch-investors

# –ü—Ä–æ—Å–º–æ—Ç—Ä —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ ETF
npm run stats-etfs

# –ü—Ä–æ—Å–º–æ—Ç—Ä —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –∏–Ω–≤–µ—Å—Ç–æ—Ä–æ–≤
npm run stats-investors

# –ê–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ—Ç—á–µ—Ç—ã
npm run report-full
npm run report-etf BBG004730N88

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã
npm run health-check
npm run health-quick
```

### –ó–∞–ø—É—Å–∫ —Å Docker

```bash
# –°–æ–∑–¥–∞–π—Ç–µ .env —Ñ–∞–π–ª —Å –≤–∞—à–∏–º —Ç–æ–∫–µ–Ω–æ–º
echo "TINKOFF_TOKEN=your_token_here" > .env

# –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
docker-compose up -d

# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
docker-compose logs -f etf-monitor

# –û—Å—Ç–∞–Ω–æ–≤–∫–∞
docker-compose down
```

–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ Docker Compose:
- **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö**: –¥–æ—Å—Ç—É–ø–Ω–∞ –Ω–∞ –ø–æ—Ä—Ç—É 5432
- **Adminer** (–≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –ë–î): http://localhost:8080
- **–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ**: —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ —Ñ–æ–Ω–æ–≤–æ–º —Ä–µ–∂–∏–º–µ

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
etf-monitor/
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ database/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ client.js          # –ö–ª–∏–µ–Ω—Ç –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ schema.sql         # SQL —Å—Ö–µ–º–∞
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ setup.js           # –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ë–î
‚îÇ   ‚îú‚îÄ‚îÄ services/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ tinkoff-api.js     # –°–µ—Ä–≤–∏—Å Tinkoff API
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ scraper.js         # –°–µ—Ä–≤–∏—Å –≤–µ–±-—Å–∫—Ä–µ–π–ø–∏–Ω–≥–∞
‚îÇ   ‚îú‚îÄ‚îÄ scripts/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ fetch-api.js       # –°–∫—Ä–∏–ø—Ç —Å–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö API
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ fetch-investors.js # –°–∫—Ä–∏–ø—Ç —Å–±–æ—Ä–∞ –∏–Ω–≤–µ—Å—Ç–æ—Ä–æ–≤
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ analytics-report.js# –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç—á–µ—Ç–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ utils/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ logger.js          # –°–∏—Å—Ç–µ–º–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ analytics.js       # –ê–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–µ —É—Ç–∏–ª–∏—Ç—ã
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ health-check.js    # –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã
‚îÇ   ‚îî‚îÄ‚îÄ index.js               # –ì–ª–∞–≤–Ω—ã–π —Ñ–∞–π–ª —Å –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–æ–º
‚îú‚îÄ‚îÄ docker-compose.yml         # Docker Compose –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îú‚îÄ‚îÄ Dockerfile                 # Docker –æ–±—Ä–∞–∑
‚îú‚îÄ‚îÄ package.json
‚îú‚îÄ‚îÄ .env.example
‚îú‚îÄ‚îÄ README.md
‚îú‚îÄ‚îÄ EXAMPLES.md                # –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
‚îî‚îÄ‚îÄ DEPLOYMENT.md              # –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—é
```

## –°—Ö–µ–º–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

### –¢–∞–±–ª–∏—Ü–∞ `etf_snapshot`
–•—Ä–∞–Ω–∏—Ç –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ —Å–Ω–∏–º–∫–∏ –¥–∞–Ω–Ω—ã—Ö ETF —Ñ–æ–Ω–¥–æ–≤:
- `figi` - FIGI –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä —Ñ–æ–Ω–¥–∞
- `data` - –ø–æ–ª–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ ETF –≤ —Ñ–æ—Ä–º–∞—Ç–µ JSONB
- `captured_at` - –≤—Ä–µ–º—è —Å–Ω—è—Ç–∏—è —Å–Ω–∏–º–∫–∞

### –¢–∞–±–ª–∏—Ü–∞ `investors_snapshot`
–•—Ä–∞–Ω–∏—Ç –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ –æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ –∏–Ω–≤–µ—Å—Ç–æ—Ä–æ–≤:
- `figi` - FIGI –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä —Ñ–æ–Ω–¥–∞
- `investors` - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏–Ω–≤–µ—Å—Ç–æ—Ä–æ–≤
- `captured_at` - –≤—Ä–µ–º—è —Å–Ω—è—Ç–∏—è —Å–Ω–∏–º–∫–∞

## API –∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

### Tinkoff Invest API
- **Rate limit**: 60 unary-–∑–∞–ø—Ä–æ—Å–æ–≤ –≤ –º–∏–Ω—É—Ç—É
- **–î–∞–Ω–Ω—ã–µ**: –ø–∞—Å–ø–æ—Ä—Ç —Ñ–æ–Ω–¥–∞, –∫–æ–º–∏—Å—Å–∏–∏, —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
- **–ù–µ —Å–æ–¥–µ—Ä–∂–∏—Ç**: —Å–æ—Å—Ç–∞–≤ –ø–æ—Ä—Ç—Ñ–µ–ª—è, –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏–Ω–≤–µ—Å—Ç–æ—Ä–æ–≤

### –í–µ–±-—Å–∫—Ä–µ–π–ø–∏–Ω–≥ T-Capital
- **–ò—Å—Ç–æ—á–Ω–∏–∫**: https://t-capital-funds.ru
- **–î–∞–Ω–Ω—ã–µ**: –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏–Ω–≤–µ—Å—Ç–æ—Ä–æ–≤, —Å–æ—Å—Ç–∞–≤ —Ñ–æ–Ω–¥–∞ (—Ç–æ–ø-10)
- **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è**: –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—ã —Å–∞–π—Ç–∞

## –ü—Ä–∏–º–µ—Ä—ã –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö

### –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –¥–∞–Ω–Ω—ã—Ö ETF

```sql
SELECT DISTINCT ON (figi) 
    figi, 
    data->>'name' as name,
    data->>'ticker' as ticker,
    captured_at
FROM etf_snapshot
ORDER BY figi, captured_at DESC;
```

### –î–∏–Ω–∞–º–∏–∫–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∏–Ω–≤–µ—Å—Ç–æ—Ä–æ–≤

```sql
SELECT 
    figi,
    investors,
    captured_at,
    LAG(investors) OVER (PARTITION BY figi ORDER BY captured_at) as prev_investors
FROM investors_snapshot
ORDER BY figi, captured_at DESC;
```

### –¢–æ–ø ETF –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –∏–Ω–≤–µ—Å—Ç–æ—Ä–æ–≤

```sql
SELECT 
    i.figi,
    e.data->>'name' as name,
    i.investors
FROM investors_snapshot i
JOIN (
    SELECT DISTINCT ON (figi) figi, data
    FROM etf_snapshot
    ORDER BY figi, captured_at DESC
) e ON i.figi = e.figi
WHERE i.captured_at = (SELECT MAX(captured_at) FROM investors_snapshot)
ORDER BY i.investors DESC
LIMIT 10;
```

## –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

–°–∏—Å—Ç–µ–º–∞ –≤—ã–≤–æ–¥–∏—Ç –ø–æ–¥—Ä–æ–±–Ω—ã–µ –ª–æ–≥–∏ –æ:
- –ü—Ä–æ—Ü–µ—Å—Å–µ —Å–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–µ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã—Ö —Ñ–æ–Ω–¥–æ–≤
- –û—à–∏–±–∫–∞—Ö –∏ –∏—Ö –ø—Ä–∏—á–∏–Ω–∞—Ö
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è

## ü§ñ –ë–æ—Ç-–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤—â–∏–∫ –ø–æ—Ä—Ç—Ñ–µ–ª—è

### –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç —Å –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤—â–∏–∫–æ–º

```bash
# 1. –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è —Ä–∞–±–æ—Ç—ã (–±–µ–∑ API)
npm run balancer-demo

# 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ç–æ–∫–µ–Ω–∞ –≤ .env
TINKOFF_TOKEN=your_token_here
DRY_RUN=true

# 3. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
npm run balancer-test

# 4. –ó–∞–ø—É—Å–∫ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Ä–µ–∂–∏–º–∞
npm run balancer-auto
```

### –ö–æ–º–∞–Ω–¥—ã –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤—â–∏–∫–∞

| –ö–æ–º–∞–Ω–¥–∞ | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|----------|
| `npm run balancer-demo` | –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è —Å –º–æ–∫–æ–≤—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏ |
| `npm run balancer-test` | –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ |
| `npm run balancer-status` | –ü–æ–∫–∞–∑–∞—Ç—å —Å—Ç–∞—Ç—É—Å –∏ –ø–æ—Ä—Ç—Ñ–µ–ª—å |
| `npm run balancer-once` | –û–¥–Ω–∞ –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞ |
| `npm run balancer-auto` | –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ä–µ–∂–∏–º |

### –ü—Ä–∏–Ω—Ü–∏–ø —Ä–∞–±–æ—Ç—ã

1. **–ê–Ω–∞–ª–∏–∑ market cap** - –ø–æ–ª—É—á–∞–µ—Ç —Å—Ç–æ–∏–º–æ—Å—Ç—å —á–∏—Å—Ç—ã—Ö –∞–∫—Ç–∏–≤–æ–≤ –≤—Å–µ—Ö —Ñ–æ–Ω–¥–æ–≤ –¢–∏–Ω—å–∫–æ—Ñ—Ñ
2. **–†–∞—Å—á–µ—Ç –ø—Ä–æ–ø–æ—Ä—Ü–∏–π** - —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç –ø–æ—Ä—Ç—Ñ–µ–ª—å –ø—Ä–æ–ø–æ—Ä—Ü–∏–æ–Ω–∞–ª—å–Ω–æ market cap
3. **–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏** - –Ω–∞—Ö–æ–¥–∏—Ç —Å–∞–º–æ–µ —Å–ø–æ–∫–æ–π–Ω–æ–µ –≤—Ä–µ–º—è –¥–ª—è —Ç–æ—Ä–≥–æ–≤–ª–∏
4. **–†–µ–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä—É–µ—Ç –ø–æ—Ä—Ç—Ñ–µ–ª—å

### –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- **DRY_RUN —Ä–µ–∂–∏–º** - —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –±–µ–∑ —Ä–µ–∞–ª—å–Ω—ã—Ö —Å–¥–µ–ª–æ–∫
- **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è** - –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ –ø–æ—Ä—Ç—Ñ–µ–ª—è 20%
- **–ê–Ω–∞–ª–∏–∑ –≤—Ä–µ–º–µ–Ω–∏** - —Ç–æ—Ä–≥–æ–≤–ª—è —Ç–æ–ª—å–∫–æ –≤ —Å–ø–æ–∫–æ–π–Ω—ã–µ —á–∞—Å—ã
- **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** - –ø–æ–ª–Ω–∞—è –∏—Å—Ç–æ—Ä–∏—è –æ–ø–µ—Ä–∞—Ü–∏–π

üìñ **–ü–æ–¥—Ä–æ–±–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è**: [BALANCER.md](BALANCER.md)

## –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏–∏

1. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –æ—à–∏–±–æ–∫**: —Ä–µ–≥—É–ª—è—Ä–Ω–æ –ø—Ä–æ–≤–µ—Ä—è–π—Ç–µ –ª–æ–≥–∏ –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –æ—à–∏–±–æ–∫
2. **–†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ**: –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ –±—ç–∫–∞–ø –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
3. **–û–±–Ω–æ–≤–ª–µ–Ω–∏—è**: —Å–ª–µ–¥–∏—Ç–µ –∑–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è–º–∏ –≤ API –∏ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ —Å–∞–π—Ç–æ–≤
4. **–†–µ—Å—É—Ä—Å—ã**: —É–±–µ–¥–∏—Ç–µ—Å—å –≤ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ—Å—Ç–∏ —Ä–µ—Å—É—Ä—Å–æ–≤ –¥–ª—è Puppeteer
5. **–ë–∞–ª–∞–Ω—Å–∏—Ä–æ–≤—â–∏–∫**: –Ω–∞—á–∏–Ω–∞–π—Ç–µ —Å DRY_RUN —Ä–µ–∂–∏–º–∞ –∏ –Ω–µ–±–æ–ª—å—à–∏—Ö —Å—É–º–º

## –õ–∏—Ü–µ–Ω–∑–∏—è

MIT License

## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

- **[BALANCER.md](BALANCER.md)** - ü§ñ –ü–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤—â–∏–∫—É –ø–æ—Ä—Ç—Ñ–µ–ª—è
- **[EXAMPLES.md](EXAMPLES.md)** - –ü–æ–¥—Ä–æ–±–Ω—ã–µ –ø—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∏ SQL –∑–∞–ø—Ä–æ—Å—ã
- **[DEPLOYMENT.md](DEPLOYMENT.md)** - –ü–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—é –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ
- **[Tinkoff Invest API](https://developer.tinkoff.ru/invest/)** - –û—Ñ–∏—Ü–∏–∞–ª—å–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è API
- **[T-Capital Funds](https://t-capital-funds.ru)** - –û—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π —Å–∞–π—Ç —Ñ–æ–Ω–¥–æ–≤

## –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –ø—Ä–æ–±–ª–µ–º:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è: `npm run health-check`
2. –£–±–µ–¥–∏—Ç–µ—Å—å –≤ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ —Ç–æ–∫–µ–Ω–∞ API
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å —Å–∞–π—Ç–∞ T-Capital
5. –ò–∑—É—á–∏—Ç–µ –ø—Ä–∏–º–µ—Ä—ã –≤ [EXAMPLES.md](EXAMPLES.md)
6. –°–ª–µ–¥—É–π—Ç–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º –≤ [DEPLOYMENT.md](DEPLOYMENT.md)
